2021/04/25 14:03:26 - root - ERROR - 20 - loger - Error
Traceback (most recent call last):
  File "D:\datawork\logs\loger.py", line 11, in wrapper
    return func(*args, **kwargs)
  File "D:\datawork\zwwork\test.py", line 6, in test1
    a = 1 / 0
ZeroDivisionError: division by zero
2021/04/26 14:27:15 - root - ERROR - 20 - loger - Error
Traceback (most recent call last):
  File "D:\python3\Lib\site-packages\pandas\io\sql.py", line 1697, in execute
    cur.execute(*args, **kwargs)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 148, in execute
    result = self._query(query)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 310, in _query
    conn.query(q)
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 547, in query
    self._execute_command(COMMAND.COM_QUERY, sql)
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 793, in _execute_command
    raise err.InterfaceError(0, "")
pymysql.err.InterfaceError: (0, '')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\python3\Lib\site-packages\pandas\io\sql.py", line 1701, in execute
    self.con.rollback()
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 479, in rollback
    self._execute_command(COMMAND.COM_QUERY, "ROLLBACK")
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 793, in _execute_command
    raise err.InterfaceError(0, "")
pymysql.err.InterfaceError: (0, '')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\datawork\logs\loger.py", line 11, in wrapper
    return func(*args, **kwargs)
  File "D:\datawork\syn_market_keep_day.py", line 100, in syn_market_book_admin_read_situation
    work.step_run_kwargs(
  File "D:\datawork\algorithm\retained.py", line 185, in step_run_kwargs
    follow_func(
  File "D:\datawork\algorithm\retained.py", line 647, in chart_book_admin_read_count_30
    ladder_by_day_count(
  File "D:\datawork\algorithm\retained.py", line 269, in ladder_by_day_count
    func(write_conn, write_db, write_tab, s_date, _date, **kwargs)
  File "D:\datawork\algorithm\retained.py", line 674, in chart_book_admin_read_count_30_day_ladder
    read_date = pd.read_sql(
  File "D:\python3\Lib\site-packages\pandas\io\sql.py", line 484, in read_sql
    return pandas_sql.read_query(
  File "D:\python3\Lib\site-packages\pandas\io\sql.py", line 1743, in read_query
    cursor = self.execute(*args)
  File "D:\python3\Lib\site-packages\pandas\io\sql.py", line 1706, in execute
    raise ex from inner_exc
pandas.io.sql.DatabaseError: Execution failed on sql: 
SELECT book_id,channel_id,last_chapter_id,is_finish,start_date,sum(start_book) start_book,
    sum(over_free) over_free,sum(over_30) over_30,sum(over_60) over_60, 
    sum(over_90) over_90, sum(over_120) over_120, sum(over_150) over_150, 
    sum(over_180) over_180, sum(over_210) over_210, sum(over_240) over_240, 
    sum(over_270) over_270, sum(over_300) over_300, sum(over_400) over_400, 
    sum(over_500) over_500, sum(over_600) over_600, sum(over_700) over_700, 
    sum(over_800) over_800,sum(over_1000) over_1000,sum(over_book) over_book
from market_read.book_admin_read_situation_30
where start_date >= '2019-06-01' and start_date < '2019-06-16' 
GROUP BY book_id,channel_id,last_chapter_id,is_finish,start_date

(0, '')
unable to rollback
2021/04/26 22:47:38 - root - ERROR - 20 - loger - Error
Traceback (most recent call last):
  File "D:\python3\Lib\site-packages\pandas\io\sql.py", line 1697, in execute
    cur.execute(*args, **kwargs)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 148, in execute
    result = self._query(query)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 310, in _query
    conn.query(q)
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 775, in _read_query_result
    result.read()
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 1163, in read
    self._read_result_packet(first_packet)
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 1236, in _read_result_packet
    self._read_rowdata_packet()
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 1274, in _read_rowdata_packet
    rows.append(self._read_row_from_packet(packet))
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 1294, in _read_row_from_packet
    data = converter(data)
MemoryError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\python3\Lib\site-packages\pandas\io\sql.py", line 1701, in execute
    self.con.rollback()
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 480, in rollback
    self._read_ok_packet()
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 443, in _read_ok_packet
    pkt = self._read_packet()
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 705, in _read_packet
    raise err.InternalError(
pymysql.err.InternalError: Packet sequence number wrong - got 39 expected 1

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\datawork\logs\loger.py", line 11, in wrapper
  File "D:\datawork\syn_market_keep_day.py", line 100, in syn_market_book_admin_read_situation
    work.step_run_kwargs(
  File "D:\datawork\algorithm\retained.py", line 185, in step_run_kwargs
    follow_func(
  File "D:\datawork\algorithm\retained.py", line 650, in chart_book_admin_read_count_30
    # read_date = pd.read_sql(
  File "D:\python3\Lib\site-packages\pandas\io\sql.py", line 484, in read_sql
    return pandas_sql.read_query(
  File "D:\python3\Lib\site-packages\pandas\io\sql.py", line 1743, in read_query
    cursor = self.execute(*args)
  File "D:\python3\Lib\site-packages\pandas\io\sql.py", line 1706, in execute
    raise ex from inner_exc
pandas.io.sql.DatabaseError: Execution failed on sql: 
SELECT book_id,channel_id,last_chapter_id,is_finish,start_date,sum(start_book) start_book,
    sum(over_free) over_free,sum(over_30) over_30,sum(over_60) over_60, 
    sum(over_90) over_90, sum(over_120) over_120, sum(over_150) over_150, 
    sum(over_180) over_180, sum(over_210) over_210, sum(over_240) over_240, 
    sum(over_270) over_270, sum(over_300) over_300, sum(over_400) over_400, 
    sum(over_500) over_500, sum(over_600) over_600, sum(over_700) over_700, 
    sum(over_800) over_800,sum(over_1000) over_1000,sum(over_book) over_book
from market_read.book_admin_read_situation_30
GROUP BY book_id,channel_id,last_chapter_id,is_finish,start_date


unable to rollback
2021/04/28 14:51:26 - root - ERROR - 20 - loger - Error
Traceback (most recent call last):
  File "D:\datawork\logs\loger.py", line 11, in wrapper
    return func(*args, **kwargs)
  File "D:\datawork\syn_shard_user_day.py", line 14, in syn_shard_user_day_work
    shard_user_day_work.loop_all_database()
  File "D:\datawork\emtools\read_database.py", line 77, in loop_all_database
    self.loop_size_table(data_base)
  File "D:\datawork\emtools\read_database.py", line 84, in loop_size_table
    self.no_size_conn(_db)
  File "D:\datawork\emtools\read_database.py", line 87, in no_size_conn
    switch_job(db_name, self.host, size, self.process_num, self.date, self.date_sub)
  File "D:\datawork\emtools\read_database.py", line 178, in switch_job
    data_job.read_dict_table(conn_fig, 'datamarket', date)
  File "D:\datawork\emtools\data_job.py", line 135, in read_dict_table
    read_custom_update(read_conn, write_conn, sql_code.sql_dict_update_custom, write_db_name, 'custom', date)
  File "D:\datawork\emtools\data_job.py", line 169, in read_custom_update
    rd.insert_to_data(data_info, write_conn, write_db_name, write_tab_name)
  File "D:\datawork\emtools\read_database.py", line 131, in insert_to_data
    cursor.executemany(_sql, _val)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 173, in executemany
    return self._do_execute_many(
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 206, in _do_execute_many
    rows += self.execute(sql + postfix)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 148, in execute
    result = self._query(query)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 310, in _query
    conn.query(q)
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 775, in _read_query_result
    result.read()
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 725, in _read_packet
    packet.raise_for_error()
  File "D:\python3\Lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "D:\python3\Lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.DataError: (1406, "Data too long for column 'message_json' at row 1")
2021/04/28 15:00:09 - root - ERROR - 20 - loger - Error
Traceback (most recent call last):
  File "D:\datawork\logs\loger.py", line 11, in wrapper
    return func(*args, **kwargs)
  File "D:\datawork\syn_shard_user_day.py", line 14, in syn_shard_user_day_work
    shard_user_day_work.loop_all_database()
  File "D:\datawork\emtools\read_database.py", line 77, in loop_all_database
    self.loop_size_table(data_base)
  File "D:\datawork\emtools\read_database.py", line 84, in loop_size_table
    self.no_size_conn(_db)
  File "D:\datawork\emtools\read_database.py", line 87, in no_size_conn
    switch_job(db_name, self.host, size, self.process_num, self.date, self.date_sub)
  File "D:\datawork\emtools\read_database.py", line 178, in switch_job
    data_job.read_dict_table(conn_fig, 'datamarket', date)
  File "D:\datawork\emtools\data_job.py", line 135, in read_dict_table
    read_custom_update(read_conn, write_conn, sql_code.sql_dict_update_custom, write_db_name, 'custom', date)
  File "D:\datawork\emtools\data_job.py", line 170, in read_custom_update
    rd.insert_to_data(data_info, write_conn, write_db_name, write_tab_name)
  File "D:\datawork\emtools\read_database.py", line 131, in insert_to_data
    cursor.executemany(_sql, _val)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 173, in executemany
    return self._do_execute_many(
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 206, in _do_execute_many
    rows += self.execute(sql + postfix)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 148, in execute
    result = self._query(query)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 310, in _query
    conn.query(q)
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 775, in _read_query_result
    result.read()
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 725, in _read_packet
    packet.raise_for_error()
  File "D:\python3\Lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "D:\python3\Lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.DataError: (1406, "Data too long for column 'message_json' at row 1")
2021/04/28 15:14:00 - root - ERROR - 20 - loger - Error
Traceback (most recent call last):
  File "D:\datawork\logs\loger.py", line 11, in wrapper
    return func(*args, **kwargs)
  File "D:\datawork\syn_shard_user_day.py", line 14, in syn_shard_user_day_work
    shard_user_day_work.loop_all_database()
  File "D:\datawork\emtools\read_database.py", line 77, in loop_all_database
    self.loop_size_table(data_base)
  File "D:\datawork\emtools\read_database.py", line 84, in loop_size_table
    self.no_size_conn(_db)
  File "D:\datawork\emtools\read_database.py", line 87, in no_size_conn
    switch_job(db_name, self.host, size, self.process_num, self.date, self.date_sub)
  File "D:\datawork\emtools\read_database.py", line 178, in switch_job
    data_job.read_dict_table(conn_fig, 'datamarket', date)
  File "D:\datawork\emtools\data_job.py", line 135, in read_dict_table
    read_custom_update(read_conn, write_conn, sql_code.sql_dict_update_custom, write_db_name, 'custom', date)
  File "D:\datawork\emtools\data_job.py", line 170, in read_custom_update
    rd.insert_to_data(data_info, write_conn, write_db_name, write_tab_name)
  File "D:\datawork\emtools\read_database.py", line 131, in insert_to_data
    cursor.executemany(_sql, _val)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 173, in executemany
    return self._do_execute_many(
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 206, in _do_execute_many
    rows += self.execute(sql + postfix)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 148, in execute
    result = self._query(query)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 310, in _query
    conn.query(q)
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 775, in _read_query_result
    result.read()
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 725, in _read_packet
    packet.raise_for_error()
  File "D:\python3\Lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "D:\python3\Lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.DataError: (1406, "Data too long for column 'message_json' at row 1")
2021/04/28 15:14:30 - root - ERROR - 20 - loger - Error
Traceback (most recent call last):
  File "D:\datawork\logs\loger.py", line 11, in wrapper
    return func(*args, **kwargs)
  File "D:\datawork\syn_shard_user_day.py", line 14, in syn_shard_user_day_work
    shard_user_day_work.loop_all_database()
  File "D:\datawork\emtools\read_database.py", line 77, in loop_all_database
    self.loop_size_table(data_base)
  File "D:\datawork\emtools\read_database.py", line 84, in loop_size_table
    self.no_size_conn(_db)
  File "D:\datawork\emtools\read_database.py", line 87, in no_size_conn
    switch_job(db_name, self.host, size, self.process_num, self.date, self.date_sub)
  File "D:\datawork\emtools\read_database.py", line 178, in switch_job
    data_job.read_dict_table(conn_fig, 'datamarket', date)
  File "D:\datawork\emtools\data_job.py", line 135, in read_dict_table
    read_custom_update(read_conn, write_conn, sql_code.sql_dict_update_custom, write_db_name, 'custom', date)
  File "D:\datawork\emtools\data_job.py", line 170, in read_custom_update
    rd.insert_to_data(data_info, write_conn, write_db_name, write_tab_name)
  File "D:\datawork\emtools\read_database.py", line 131, in insert_to_data
    cursor.executemany(_sql, _val)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 173, in executemany
    return self._do_execute_many(
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 206, in _do_execute_many
    rows += self.execute(sql + postfix)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 148, in execute
    result = self._query(query)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 310, in _query
    conn.query(q)
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 775, in _read_query_result
    result.read()
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 725, in _read_packet
    packet.raise_for_error()
  File "D:\python3\Lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "D:\python3\Lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.DataError: (1406, "Data too long for column 'message_json' at row 1")
2021/04/28 15:15:00 - root - ERROR - 20 - loger - Error
Traceback (most recent call last):
  File "D:\datawork\logs\loger.py", line 11, in wrapper
    return func(*args, **kwargs)
  File "D:\datawork\syn_shard_user_day.py", line 14, in syn_shard_user_day_work
    shard_user_day_work.loop_all_database()
  File "D:\datawork\emtools\read_database.py", line 77, in loop_all_database
    self.loop_size_table(data_base)
  File "D:\datawork\emtools\read_database.py", line 84, in loop_size_table
    self.no_size_conn(_db)
  File "D:\datawork\emtools\read_database.py", line 87, in no_size_conn
    switch_job(db_name, self.host, size, self.process_num, self.date, self.date_sub)
  File "D:\datawork\emtools\read_database.py", line 179, in switch_job
    data_job.read_dict_table(conn_fig, 'datamarket', date)
  File "D:\datawork\emtools\data_job.py", line 135, in read_dict_table
    read_custom_update(read_conn, write_conn, sql_code.sql_dict_update_custom, write_db_name, 'custom', date)
  File "D:\datawork\emtools\data_job.py", line 170, in read_custom_update
    rd.insert_to_data(data_info, write_conn, write_db_name, write_tab_name)
  File "D:\datawork\emtools\read_database.py", line 132, in insert_to_data
    cursor.executemany(_sql, _val)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 173, in executemany
    return self._do_execute_many(
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 206, in _do_execute_many
    rows += self.execute(sql + postfix)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 148, in execute
    result = self._query(query)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 310, in _query
    conn.query(q)
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 775, in _read_query_result
    result.read()
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 725, in _read_packet
    packet.raise_for_error()
  File "D:\python3\Lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "D:\python3\Lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.DataError: (1406, "Data too long for column 'message_json' at row 1")
2021/04/28 15:18:01 - root - ERROR - 20 - loger - Error
Traceback (most recent call last):
  File "D:\datawork\logs\loger.py", line 11, in wrapper
    return func(*args, **kwargs)
  File "D:\datawork\syn_shard_user_day.py", line 14, in syn_shard_user_day_work
    shard_user_day_work.loop_all_database()
  File "D:\datawork\emtools\read_database.py", line 77, in loop_all_database
    self.loop_size_table(data_base)
  File "D:\datawork\emtools\read_database.py", line 84, in loop_size_table
    self.no_size_conn(_db)
  File "D:\datawork\emtools\read_database.py", line 87, in no_size_conn
    switch_job(db_name, self.host, size, self.process_num, self.date, self.date_sub)
  File "D:\datawork\emtools\read_database.py", line 178, in switch_job
    data_job.read_dict_table(conn_fig, 'datamarket', date)
  File "D:\datawork\emtools\data_job.py", line 135, in read_dict_table
    read_custom_update(read_conn, write_conn, sql_code.sql_dict_update_custom, write_db_name, 'custom', date)
  File "D:\datawork\emtools\data_job.py", line 170, in read_custom_update
    rd.subsection_insert_to_data(data_info, write_conn, write_db_name, write_tab_name)
  File "D:\datawork\emtools\read_database.py", line 141, in subsection_insert_to_data
    _subsection_insert(conn, _sql, _val)
  File "D:\datawork\emtools\read_database.py", line 153, in _subsection_insert
    _data_executemany(conn, _sql, val_sub)
  File "D:\datawork\emtools\read_database.py", line 159, in _data_executemany
    cursor.executemany(_sql, _val)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 173, in executemany
    return self._do_execute_many(
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 206, in _do_execute_many
    rows += self.execute(sql + postfix)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 148, in execute
    result = self._query(query)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 310, in _query
    conn.query(q)
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 775, in _read_query_result
    result.read()
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 725, in _read_packet
    packet.raise_for_error()
  File "D:\python3\Lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "D:\python3\Lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.DataError: (1406, "Data too long for column 'message_json' at row 1")
2021/04/28 15:20:02 - root - ERROR - 20 - loger - Error
Traceback (most recent call last):
  File "D:\datawork\logs\loger.py", line 11, in wrapper
    return func(*args, **kwargs)
  File "D:\datawork\syn_shard_user_day.py", line 14, in syn_shard_user_day_work
    shard_user_day_work.loop_all_database()
  File "D:\datawork\emtools\read_database.py", line 77, in loop_all_database
    self.loop_size_table(data_base)
  File "D:\datawork\emtools\read_database.py", line 84, in loop_size_table
    self.no_size_conn(_db)
  File "D:\datawork\emtools\read_database.py", line 87, in no_size_conn
    switch_job(db_name, self.host, size, self.process_num, self.date, self.date_sub)
  File "D:\datawork\emtools\read_database.py", line 178, in switch_job
    data_job.read_dict_table(conn_fig, 'datamarket', date)
  File "D:\datawork\emtools\data_job.py", line 135, in read_dict_table
    read_custom_update(read_conn, write_conn, sql_code.sql_dict_update_custom, write_db_name, 'custom', date)
  File "D:\datawork\emtools\data_job.py", line 171, in read_custom_update
    rd.subsection_insert_to_data(data_info, write_conn, write_db_name, write_tab_name)
  File "D:\datawork\emtools\read_database.py", line 141, in subsection_insert_to_data
    _subsection_insert(conn, _sql, _val)
  File "D:\datawork\emtools\read_database.py", line 153, in _subsection_insert
    _data_executemany(conn, _sql, val_sub)
  File "D:\datawork\emtools\read_database.py", line 159, in _data_executemany
    cursor.executemany(_sql, _val)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 173, in executemany
    return self._do_execute_many(
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 206, in _do_execute_many
    rows += self.execute(sql + postfix)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 148, in execute
    result = self._query(query)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 310, in _query
    conn.query(q)
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 775, in _read_query_result
    result.read()
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 725, in _read_packet
    packet.raise_for_error()
  File "D:\python3\Lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "D:\python3\Lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.DataError: (1406, "Data too long for column 'message_json' at row 1")
2021/04/28 15:23:19 - root - ERROR - 20 - loger - Error
Traceback (most recent call last):
  File "D:\datawork\logs\loger.py", line 11, in wrapper
    return func(*args, **kwargs)
  File "D:\datawork\syn_shard_user_day.py", line 14, in syn_shard_user_day_work
    shard_user_day_work.loop_all_database()
  File "D:\datawork\emtools\read_database.py", line 77, in loop_all_database
    self.loop_size_table(data_base)
  File "D:\datawork\emtools\read_database.py", line 84, in loop_size_table
    self.no_size_conn(_db)
  File "D:\datawork\emtools\read_database.py", line 87, in no_size_conn
    switch_job(db_name, self.host, size, self.process_num, self.date, self.date_sub)
  File "D:\datawork\emtools\read_database.py", line 179, in switch_job
    data_job.read_dict_table(conn_fig, 'datamarket', date)
  File "D:\datawork\emtools\data_job.py", line 135, in read_dict_table
    read_custom_update(read_conn, write_conn, sql_code.sql_dict_update_custom, write_db_name, 'custom', date)
  File "D:\datawork\emtools\data_job.py", line 171, in read_custom_update
    rd.subsection_insert_to_data(data_info, write_conn, write_db_name, write_tab_name)
  File "D:\datawork\emtools\read_database.py", line 142, in subsection_insert_to_data
    _subsection_insert(conn, _sql, _val)
  File "D:\datawork\emtools\read_database.py", line 154, in _subsection_insert
    _data_executemany(conn, _sql, val_sub)
  File "D:\datawork\emtools\read_database.py", line 160, in _data_executemany
    cursor.executemany(_sql, _val)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 173, in executemany
    return self._do_execute_many(
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 206, in _do_execute_many
    rows += self.execute(sql + postfix)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 148, in execute
    result = self._query(query)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 310, in _query
    conn.query(q)
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 775, in _read_query_result
    result.read()
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 725, in _read_packet
    packet.raise_for_error()
  File "D:\python3\Lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "D:\python3\Lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.DataError: (1406, "Data too long for column 'message_json' at row 1")
2021/04/28 15:23:45 - root - ERROR - 20 - loger - Error
Traceback (most recent call last):
  File "D:\datawork\logs\loger.py", line 11, in wrapper
    return func(*args, **kwargs)
  File "D:\datawork\syn_shard_user_day.py", line 14, in syn_shard_user_day_work
    shard_user_day_work.loop_all_database()
  File "D:\datawork\emtools\read_database.py", line 77, in loop_all_database
    self.loop_size_table(data_base)
  File "D:\datawork\emtools\read_database.py", line 84, in loop_size_table
    self.no_size_conn(_db)
  File "D:\datawork\emtools\read_database.py", line 87, in no_size_conn
    switch_job(db_name, self.host, size, self.process_num, self.date, self.date_sub)
  File "D:\datawork\emtools\read_database.py", line 180, in switch_job
    data_job.read_dict_table(conn_fig, 'datamarket', date)
  File "D:\datawork\emtools\data_job.py", line 135, in read_dict_table
    read_custom_update(read_conn, write_conn, sql_code.sql_dict_update_custom, write_db_name, 'custom', date)
  File "D:\datawork\emtools\data_job.py", line 171, in read_custom_update
    rd.subsection_insert_to_data(data_info, write_conn, write_db_name, write_tab_name)
  File "D:\datawork\emtools\read_database.py", line 143, in subsection_insert_to_data
    _subsection_insert(conn, _sql, _val)
  File "D:\datawork\emtools\read_database.py", line 155, in _subsection_insert
    _data_executemany(conn, _sql, val_sub)
  File "D:\datawork\emtools\read_database.py", line 161, in _data_executemany
    cursor.executemany(_sql, _val)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 173, in executemany
    return self._do_execute_many(
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 206, in _do_execute_many
    rows += self.execute(sql + postfix)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 148, in execute
    result = self._query(query)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 310, in _query
    conn.query(q)
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 775, in _read_query_result
    result.read()
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 725, in _read_packet
    packet.raise_for_error()
  File "D:\python3\Lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "D:\python3\Lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.DataError: (1406, "Data too long for column 'message_json' at row 1")
2021/04/28 15:24:49 - root - ERROR - 20 - loger - Error
Traceback (most recent call last):
  File "D:\datawork\logs\loger.py", line 11, in wrapper
    return func(*args, **kwargs)
  File "D:\datawork\syn_shard_user_day.py", line 14, in syn_shard_user_day_work
    shard_user_day_work.loop_all_database()
  File "D:\datawork\emtools\read_database.py", line 77, in loop_all_database
    self.loop_size_table(data_base)
  File "D:\datawork\emtools\read_database.py", line 84, in loop_size_table
    self.no_size_conn(_db)
  File "D:\datawork\emtools\read_database.py", line 87, in no_size_conn
    switch_job(db_name, self.host, size, self.process_num, self.date, self.date_sub)
  File "D:\datawork\emtools\read_database.py", line 183, in switch_job
    data_job.read_dict_table(conn_fig, 'datamarket', date)
  File "D:\datawork\emtools\data_job.py", line 135, in read_dict_table
    read_custom_update(read_conn, write_conn, sql_code.sql_dict_update_custom, write_db_name, 'custom', date)
  File "D:\datawork\emtools\data_job.py", line 171, in read_custom_update
    rd.subsection_insert_to_data(data_info, write_conn, write_db_name, write_tab_name)
  File "D:\datawork\emtools\read_database.py", line 143, in subsection_insert_to_data
    _subsection_insert(conn, _sql, _val)
  File "D:\datawork\emtools\read_database.py", line 158, in _subsection_insert
    _data_executemany(conn, _sql, val_sub)
  File "D:\datawork\emtools\read_database.py", line 164, in _data_executemany
    cursor.executemany(_sql, _val)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 173, in executemany
    return self._do_execute_many(
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 206, in _do_execute_many
    rows += self.execute(sql + postfix)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 148, in execute
    result = self._query(query)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 310, in _query
    conn.query(q)
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 775, in _read_query_result
    result.read()
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 725, in _read_packet
    packet.raise_for_error()
  File "D:\python3\Lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "D:\python3\Lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.DataError: (1406, "Data too long for column 'message_json' at row 1")
2021/04/28 15:25:38 - root - ERROR - 20 - loger - Error
Traceback (most recent call last):
  File "D:\datawork\logs\loger.py", line 11, in wrapper
    return func(*args, **kwargs)
  File "D:\datawork\syn_shard_user_day.py", line 14, in syn_shard_user_day_work
    shard_user_day_work.loop_all_database()
  File "D:\datawork\emtools\read_database.py", line 77, in loop_all_database
    self.loop_size_table(data_base)
  File "D:\datawork\emtools\read_database.py", line 84, in loop_size_table
    self.no_size_conn(_db)
  File "D:\datawork\emtools\read_database.py", line 87, in no_size_conn
    switch_job(db_name, self.host, size, self.process_num, self.date, self.date_sub)
  File "D:\datawork\emtools\read_database.py", line 184, in switch_job
    data_job.read_dict_table(conn_fig, 'datamarket', date)
  File "D:\datawork\emtools\data_job.py", line 135, in read_dict_table
    read_custom_update(read_conn, write_conn, sql_code.sql_dict_update_custom, write_db_name, 'custom', date)
  File "D:\datawork\emtools\data_job.py", line 171, in read_custom_update
    rd.subsection_insert_to_data(data_info, write_conn, write_db_name, write_tab_name)
  File "D:\datawork\emtools\read_database.py", line 143, in subsection_insert_to_data
    _subsection_insert(conn, _sql, _val)
  File "D:\datawork\emtools\read_database.py", line 159, in _subsection_insert
    _data_executemany(conn, _sql, val_sub)
  File "D:\datawork\emtools\read_database.py", line 165, in _data_executemany
    cursor.executemany(_sql, _val)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 173, in executemany
    return self._do_execute_many(
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 206, in _do_execute_many
    rows += self.execute(sql + postfix)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 148, in execute
    result = self._query(query)
  File "D:\python3\Lib\site-packages\pymysql\cursors.py", line 310, in _query
    conn.query(q)
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 775, in _read_query_result
    result.read()
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
  File "D:\python3\Lib\site-packages\pymysql\connections.py", line 725, in _read_packet
    packet.raise_for_error()
  File "D:\python3\Lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "D:\python3\Lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.DataError: (1406, "Data too long for column 'message_json' at row 1")
